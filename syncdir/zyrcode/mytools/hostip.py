#!/usr/bin/env python
# partial:
host2shorthostname={
't1': 'tarekc29',
'e44': 'e44',
}

ip2host={
'128.174.238.11': 'e11',
'172.22.68.99': 't82',
}

host2ip={
'e11':'128.174.238.11',
't82': '172.22.68.99',
}

host2userip={
'e11':'root@128.174.238.11',
't82': 'zhao97@172.22.68.99',
}

tarekc2powerport={
'tarekc39':'tarek4234-ckt21-pdu.cs.illinois.edu 2',
'tarekc40':'tarek4234-ckt21-pdu.cs.illinois.edu 3',
'tarekc31':'tarek4234-ckt21-pdu.cs.illinois.edu 4',
'tarekc22':'tarek4234-ckt21-pdu.cs.illinois.edu 5',
'tarekc35':'tarek4234-ckt21-pdu.cs.illinois.edu 6',
'tarekc21':'tarek4234-ckt21-pdu.cs.illinois.edu 7',
'tarekc11':'tarek4234-ckt21-pdu.cs.illinois.edu 10',
'tarekc09':'tarek4234-ckt21-pdu.cs.illinois.edu 11',
'tarekc10':'tarek4234-ckt21-pdu.cs.illinois.edu 12',
'tarekc23':'tarek4234-ckt21-pdu.cs.illinois.edu 13',
'tarekc08':'tarek4234-ckt21-pdu.cs.illinois.edu 14',
'tarekc12':'tarek4234-ckt21-pdu.cs.illinois.edu 15',
'tarekc04':'tarek4234-ckt21-pdu.cs.illinois.edu 16',
'tarekc17':'tarek4234-ckt21-pdu.cs.illinois.edu 18',
'tarekc14':'tarek4234-ckt21-pdu.cs.illinois.edu 19',
'tarekc13':'tarek4234-ckt21-pdu.cs.illinois.edu 20',
'tarekc15':'tarek4234-ckt21-pdu.cs.illinois.edu 21',
'tarekc16':'tarek4234-ckt21-pdu.cs.illinois.edu 22',
'tarekc27':'tarek4234-ckt21-pdu.cs.illinois.edu 23',
'tarekc20':'tarek4234-ckt21-pdu.cs.illinois.edu 24',
'tarekc37':'tarek4234-ckt22-pdu.cs.illinois.edu 2',
'tarekc36':'tarek4234-ckt22-pdu.cs.illinois.edu 3',
'tarekc38':'tarek4234-ckt22-pdu.cs.illinois.edu 4',
'tarekc33':'tarek4234-ckt22-pdu.cs.illinois.edu 5',
'tarekc32':'tarek4234-ckt22-pdu.cs.illinois.edu 6',
'tarekc34':'tarek4234-ckt22-pdu.cs.illinois.edu 7',
'tarekc29':'tarek4234-ckt22-pdu.cs.illinois.edu 10',
'tarekc28':'tarek4234-ckt22-pdu.cs.illinois.edu 11',
'tarekc30':'tarek4234-ckt22-pdu.cs.illinois.edu 12',
'tarekc26':'tarek4234-ckt22-pdu.cs.illinois.edu 13',
'tarekc25':'tarek4234-ckt22-pdu.cs.illinois.edu 14',
'tarekc24':'tarek4234-ckt22-pdu.cs.illinois.edu 15',
'tarekc18':'tarek4234-ckt22-pdu.cs.illinois.edu 16',
'tarekc01':'tarek4234-ckt22-pdu.cs.illinois.edu 18',
'tarekc02':'tarek4234-ckt22-pdu.cs.illinois.edu 19',
'tarekc03':'tarek4234-ckt22-pdu.cs.illinois.edu 20',
'tarekc05':'tarek4234-ckt22-pdu.cs.illinois.edu 21',
'tarekc07':'tarek4234-ckt22-pdu.cs.illinois.edu 22',
'tarekc06':'tarek4234-ckt22-pdu.cs.illinois.edu 23',
'tarekc19':'tarek4234-ckt22-pdu.cs.illinois.edu 24',
'tarekc60':'tarek4234-ckt23-pdu.cs.illinois.edu 3',
'tarekc59':'tarek4234-ckt23-pdu.cs.illinois.edu 4',
'tarekc58':'tarek4234-ckt23-pdu.cs.illinois.edu 5',
'tarekc57':'tarek4234-ckt23-pdu.cs.illinois.edu 6',
'tarekc56':'tarek4234-ckt23-pdu.cs.illinois.edu 7',
'tarekc55':'tarek4234-ckt23-pdu.cs.illinois.edu 8',
'tarekc54':'tarek4234-ckt23-pdu.cs.illinois.edu 10',
'tarekc53':'tarek4234-ckt23-pdu.cs.illinois.edu 11',
'tarekc52':'tarek4234-ckt23-pdu.cs.illinois.edu 12',
'tarekc51':'tarek4234-ckt23-pdu.cs.illinois.edu 13',
'tarekc50':'tarek4234-ckt23-pdu.cs.illinois.edu 14',
'tarekc49':'tarek4234-ckt23-pdu.cs.illinois.edu 15',
'tarekc48':'tarek4234-ckt23-pdu.cs.illinois.edu 16',
'tarekc47':'tarek4234-ckt23-pdu.cs.illinois.edu 18',
'tarekc46':'tarek4234-ckt23-pdu.cs.illinois.edu 19',
'tarekc46':'tarek4234-ckt23-pdu.cs.illinois.edu 20',
'tarekc44':'tarek4234-ckt23-pdu.cs.illinois.edu 21',
'tarekc43':'tarek4234-ckt23-pdu.cs.illinois.edu 22',
'tarekc42':'tarek4234-ckt23-pdu.cs.illinois.edu 23',
'tarekc41':'tarek4234-ckt23-pdu.cs.illinois.edu 24',
'switch':'tarek4234-ckt24-pdu.cs.illinois.edu 3',
'tarekc79':'tarek4234-ckt24-pdu.cs.illinois.edu 4',
'tarekc78':'tarek4234-ckt24-pdu.cs.illinois.edu 5',
'tarekc77':'tarek4234-ckt24-pdu.cs.illinois.edu 6',
'tarekc76':'tarek4234-ckt24-pdu.cs.illinois.edu 7',
'tarekc75':'tarek4234-ckt24-pdu.cs.illinois.edu 8',
'tarekc74':'tarek4234-ckt24-pdu.cs.illinois.edu 10',
'tarekc73':'tarek4234-ckt24-pdu.cs.illinois.edu 11',
'tarekc72':'tarek4234-ckt24-pdu.cs.illinois.edu 12',
'tarekc71':'tarek4234-ckt24-pdu.cs.illinois.edu 13',
'tarekc70':'tarek4234-ckt24-pdu.cs.illinois.edu 14',
'tarekc69':'tarek4234-ckt24-pdu.cs.illinois.edu 15',
'tarekc68':'tarek4234-ckt24-pdu.cs.illinois.edu 16',
'tarekc67':'tarek4234-ckt24-pdu.cs.illinois.edu 18',
'tarekc66':'tarek4234-ckt24-pdu.cs.illinois.edu 19',
'tarekc65':'tarek4234-ckt24-pdu.cs.illinois.edu 20',
'tarekc64':'tarek4234-ckt24-pdu.cs.illinois.edu 21',
'tarekc63':'tarek4234-ckt24-pdu.cs.illinois.edu 22',
'tarekc62':'tarek4234-ckt24-pdu.cs.illinois.edu 23',
'tarekc61':'tarek4234-ckt24-pdu.cs.illinois.edu 24',
}

ip2tarekc={
'172.22.68.7': 'tarekc01',
'172.22.68.99': 'tarekc79',
}
tarekc2ip={
'tarekc01': '172.22.68.7' ,
'tarekc79': '172.22.68.99' ,
}
tarekc2numvcore = {
'tarekc55': 12,
'tarekc72':12,
}

def get_username(addr):
	addr=addr.split("@")[-1]
	if addr.startswith('tarekc'):
		return 'zhao97'
	if addr.startswith('172.22'):
		return 'zhao97'
	if addr.startswith('greengps'):
		return 'yiran'
	if addr.startswith('128.174.236'):
		return 'yiran'
	return ""

def get_servers(params={}):
	import os
	HomeDir = os.path.expanduser("~")
	rt = params.get("realtime",False)
	pool = []
	highcnt=0
	if rt:
		hostsFile = "/hostrank-rt.txt" # changing
	else:
		hostsFile = "/hostrank.txt"
	if not os.path.exists(HomeDir+hostsFile):
		cmd = "wget -O "+HomeDir+hostsFile+" http://greengps.cs.illinois.edu/files/static"+hostsFile
		import subprocess
		subprocess.call(cmd,shell=True)
	with open(HomeDir+hostsFile,"r") as fd:
		for l in fd:
			st=l.strip().split(" ")
			hname = st[0]
			mem = int(st[1])
			ncpu = int(st[-1])
			try:
				pool.append({"h":tarekc2ip[hname], "m":mem, "c": ncpu})
			except:
				pool.append({"h":hname, "m":mem, "c": ncpu})
			if ncpu>4:
				highcnt+=1 

	totalnum=len(pool)
	rangeList = params.get("rangeList", None)
	highLow = params.get("highLow","high").lower()
	num = params.get("num",1)

	if rangeList is None:
		rangeList=[0,0]
		if num>0:
			rangeList[0]=0
			rangeList[1]=num-1
		if highLow.startswith("low"):
			rangeList[0]+=highcnt
			rangeList[1]+=highcnt
	ret = []
	for i in range(rangeList[0],rangeList[1]+1):
		ret.append(pool[i%totalnum]["h"])
	return ret

